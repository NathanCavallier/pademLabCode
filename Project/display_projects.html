<!-- Description: Afficher la liste des projets en cours -->

<body>
    <!-- Afficher la liste des projets en cours -->
    <ul id="projectsList" style="color: aliceblue;"></ul>
</body>


<script>
    // Projet: Récurérer les données depuis la base de données et les afficher dans des cellules individuels cliquables pour les modifier
    document.addEventListener('DOMContentLoaded', () => {
        // Déclarer les variables
        var userId;
        var userEmail = '';
        var userRole = '';
        var buttonText = 'Compléter le projet';
        var numberOfMembers = 0;
        var localStatus = '';
        var projectStatus = '';

        // Récupérer la liste des projets depuis la base de données (à partir de l'API (https://lab.padem.org/wp-json/mo/v1/getProjects))
        // les projets sont affichés dans des lignes individuelles avec un bouton cliquables pour les modifier
        fetch('https://lab.padem.org/wp-json/mo/v1/getProjects', {
            method: 'GET',
            headers: {
                'Content-Type': 'application/json',
            },
        })
            .then(response => response.json())
            .then(data => {
                console.log(data);
                var colorStatusText = {
                    'En cours': 'green',
                    'Terminé': 'lightred',
                    'En pause': 'lightblue',
                    'Annulé': 'gray',
                    'Non commencé': 'lightgray',
                };
                var colorStatusBackground = {
                    'Complet': 'green',
                    'Incomplet': 'red',
                };
                var stepper = 0;
                // Parcourir la liste des projets
                data.forEach(project => {
                    // Créer un élément de liste pour chaque projet
                    var li = document.createElement('li');
                    var project_id = project.project_id;

                    // Ajouter le titre du projet, la date de début, la date de fin, le pays, le référent et le statut dans des éléments individuels
                    li.style.color = 'black';
                    li.style.textAlign = 'left';
                    li.style.border = 'none';
                    li.style.borderRadius = '15px';
                    li.style.backgroundColor = '#98CFCF';
                    li.style.height = 'auto';
                    li.style.width = '95%';
                    li.style.display = 'flex';
                    li.style.justifyContent = 'space-between';
                    li.style.padding = '10px';
                    li.style.margin = '10px';
                    li.style.border = '1px';
                    li.style.textDecoration = 'none';

                    projectStatus = project.project_status;
                    numberOfMembers = project.users_list.length;
                    if (numberOfMembers === 0 || project.users_list === null || project.users_list === undefined) {
                        localStatus = 'Incomplet';
                        buttonText = 'Compléter le projet';
                        projectStatus = 'Non commencé';
                    } else if (numberOfMembers > 0) {
                        localStatus = 'Complet';
                        buttonText = 'Modifier le projet';
                        projectStatus = 'En cours';
                    }

                    // Ajouter les données dans l'élément de liste
                    li.innerHTML = `
                        <div style="list-style-type: none; padding: 5px; margin: 5px; border-radius: 10px;">
                            <ul class="project-row" style="width: fit-content;">
                                <li class="project-element" style="font-weight: bold; color: #29A6A7;">${project.project_title}</li>
                                <li class="project-element">${project.project_location}</li>
                                <li class="project-element">Membres: ${numberOfMembers}</li>
                                <li class="project-element" style="text-transform: capitalize; font-weight: bold; color: ${colorStatusText[projectStatus]}; background: white; margin: 5px; padding: 5px; boder-radius: 20px;" id="status_${project.project_id}">${projectStatus}</li>
                                <li class="project-element" style="font-weight: bold; font-size: 11px; color: ${colorStatusBackground[localStatus]};">${localStatus}</li>
                                <li class="project-element" style="display: 'flex'; justify-content: 'flex-end';">
                                    <div style="margin-right: 10px;"></div>
                                    <button class="buttonModifier" id="buttonModifier_${project_id}" style="margin: 5px; padding: 5px; boder-radius: 20px; font-size: 11px;">${buttonText}</button>
                                </li>
                            </ul>
                            <div id="modifyProject_${project_id}" style="display: none; width: 100%; height: auto; background: white; margin: 10px; padding: 10px; border-radius: 10px; border: 1px #5AC4C4D0;">
                                <hr style="border: 1px solid #29A6A7;">
                                <div style="margin: 5px; padding: 5px;"></div>
                                <div class="row">
                                    <div class="col-md-12">
                                    <div class="row">
                                    <div style="margin-top: 5px; padding: 5px;"></div>
                                    <div class="container">
                                        <!-- Afficher une liste de boutons à l'horizontale permettant de faire apparaître le type d'éléments à ajouter au projet -->
                                        <div class="col-md-12" width: 100%; background: white;">
                                            <div class="row">
                                                <div class="btn-group" role="group" aria-label="menu">
                                                    <button type="button" id="buttonNewMember_${project_id}" class="btn btn-secondary"
                                                        style="width: fit-content; margin: 5px; padding: 5px; background: #29A6A7; color: white; font-size: 10px; border-radius: 20px;">
                                                        Nouveau membre</button>
                                                    <button type="button" id="buttonExistingMember_${project_id}" class="btn btn-secondary"
                                                        style="width: fit-content; margin: 5px; padding: 5px; background: #29A6A7; color: white; font-size: 10px; border-radius: 20px;">
                                                        Membre existant</button>
                                                    <button type="button" id="buttonReportRequest_${project_id}" class="btn btn-secondary"
                                                        style="width: fit-content; margin: 5px; padding: 5px; background: #29A6A7; color: white; font-size: 10px; border-radius: 20px;">
                                                        Demande de Rapport</button>
                                                    <button type="button" id="buttonDocumentModel_${project_id}" class="btn btn-secondary"
                                                        style="width: fit-content; margin: 5px; padding: 5px; background: #29A6A7; color: white; font-size: 10px; border-radius: 20px;">
                                                        Document model</button>
                                                    <button type="button" id="buttonAddLink_${project_id}" class="btn btn-secondary"
                                                        style="width: fit-content; margin: 5px; padding: 5px; background: #29A6A7; color: white; font-size: 10px; border-radius: 20px;">
                                                        Ajouter un Lien</button>
                                                    <button type="button" id="buttonAddDivers_${project_id}" class="btn btn-secondary"
                                                        style="width: fit-content; margin: 5px; padding: 5px; background: #29A6A7; color: white; font-size: 10px; border-radius: 20px;">
                                                        Divers</button>
                                                </div>
                                            </div>
                                            <div style="margin: 5px; padding: 5px;"></div>
                                            <div id="newMember_${project_id}" style="display: none;">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <div class="form-group">
                                                            <label for="newMemberEmail_${project_id}" required>Adresse email du nouveau membre</label>
                                                            <input type="email" class="form-control" id="newMemberEmail_${project_id}" aria-describedby="emailHelp">
                                                            <label for="last_name_${project_id}">Nom</label>
                                                            <input type="text" class="form-control" id="last_name_${project_id}" aria-describedby="emailHelp">
                                                            <label for="first_name_${project_id}">Prénom</label>
                                                            <input type="text" class="form-control" id="first_name_${project_id}" aria-describedby="emailHelp">
                                                        </div>
                                                    </div>
                                                    <div class="col-md-12">
                                                        <div class="form-group">
                                                            <label for="newMemberRole_${project_id}">Rôle du nouveau membre</label>
                                                            <select class="form-control" id="newMemberRole_${project_id}" required>
                                                                <option value="Coordinateur">Coordinateur</option>
                                                                <option value="chef-de-projet">Chef de projet</option>
                                                                <option value="comptable">Comptable</option>
                                                                <option value="consultant">Consultant</option>
                                                                <option value="partenaire">Partenaire</option>
                                                                <option value="bailleur">Bailleur</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div style="margin-top: 10px; padding: 10px;"></div>
                                                    <div class="col-md-12">
                                                        <button type="submit" class="btn btn-primary" id="buttonAddMember_${project_id}">Ajouter le nouveau membre</button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div id="existingMember_${project_id}" style="display: none;">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <div class="form-group">
                                                            <label for="existingMemberEmail_${project_id}">Adresse email du membre existant</label>
                                                            <select class="form-control" id="existingMemberEmail_${project_id}" required>
                                                            </select>
                                                        </div>
                                                        <div class="form-group">
                                                            <label for="existingMember_last_name_${project_id}">Nom du membre existant</label>
                                                            <input type="text" class="form-control" id="existingMember_last_name_${project_id}" aria-describedby="emailHelp">
                                                            <label for="existingMember_first_name_${project_id}">Prénom du membre existant</label>
                                                            <input type="text" class="form-control" id="existingMember_first_name_${project_id}" aria-describedby="emailHelp">
                                                        </div>
                                                    </div>
                                                    <div class="col-md-12">
                                                        <div class="form-group">
                                                            <label for="existingMemberRole_${project_id}">Rôle du membre existant</label>
                                                            <select class="form-control" id="existingMemberRole_${project_id}" required>
                                                                <option value="Coordinateur">Coordinateur</option>
                                                                <option value="chef-de-projet">Chef de projet</option>
                                                                <option value="comptable">Comptable</option>
                                                                <option value="consultant">Consultant</option>
                                                                <option value="partenaire">Partenaire</option>
                                                                <option value="bailleur">Bailleur</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div style="margin-top: 10px; padding: 10px;"></div>
                                                    <div class="col-md-12">
                                                        <button type="submit" class="btn btn-primary" id="addExistingMember_${project_id}">Ajouter le membre existant</button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div id="newReport_${project_id}" style="display: none;">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <div class="form-group">
                                                            <label for="reportTitle_${project_id}">Titre du rapport</label>
                                                            <input type="text" class="form-control" id="reportTitle_${project_id}" aria-describedby="emailHelp">
                                                        </div>
                                                    </div>
                                                    <div class="col-md-12">
                                                        <div class="form-group">
                                                            <label for="reportDescription_${project_id}">Description du rapport</label>
                                                            <textarea class="form-control" id="reportDescription_${project_id}" rows="5"></textarea>
                                                        </div>
                                                    </div>
                                                    <div style="margin-top: 10px; padding: 10px;"></div>
                                                    <div class="col-md-12">
                                                        <button type="submit" class="btn btn-primary" id="submitReport_${project_id}">Ajouter le rapport</button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div id="newDocument_${project_id}" style="display: none;">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <div class="form-group">
                                                            <label for="documentTitle_${project_id}">Titre du document</label>
                                                            <input type="text" class="form-control" id="documentTitle_${project_id}" aria-describedby="emailHelp">
                                                        </div>
                                                    </div>
                                                    <div class="col-md-12">
                                                        <div class="form-group">
                                                            <label for="documentDescription_${project_id}">Description du document</label>
                                                            <textarea class="form-control" id="documentDescription_${project_id}" rows="5"></textarea>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-12">
                                                        <div class="form-group">
                                                            <label for="documentFile_${project_id}">Charger le document </label>
                                                            <input type="file" class="form-control-file" id="documentFile_${project_id}">
                                                        </div>
                                                    </div>
                                                    <div style="margin-top: 10px; padding: 10px;"></div>
                                                    <div class="col-md-12">
                                                        <button type="submit" class="btn btn-primary" id="newDocument_${project_id}">Ajouter le document</button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div id="newLink_${project_id}" style="display: none;">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <div class="form-group">
                                                            <label for="linkTitle_${project_id}">Titre du lien</label>
                                                            <input type="text" class="form-control" id="linkTitle_${project_id}" aria-describedby="emailHelp">
                                                        </div>
                                                    </div>
                                                    <div class="col-md-12">
                                                        <div class="form-group">
                                                            <label for="linkDescription_${project_id}">Description du lien</label>
                                                            <textarea class="form-control" id="linkDescription_${project_id}" rows="5"></textarea>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-12">
                                                        <div class="form-group">
                                                            <label for="linkUrl_${project_id}">URL du lien</label>
                                                            <input type="text" class="form-control" id="linkUrl_${project_id}" aria-describedby="emailHelp">
                                                        </div>
                                                    </div>
                                                    <div style="margin-top: 10px; padding: 10px;"></div>
                                                    <div class="col-md-12">
                                                        <button type="submit" class="btn btn-primary" id="linkSubmit_${project_id}">Ajouter le lien</button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div id="newMisc_${project_id}" style="display: none;">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <div class="form-group">
                                                            <label for="miscTitle_${project_id}">Titre de l'élément</label>
                                                            <input type="text" class="form-control" id="miscTitle_${project_id}" aria-describedby="emailHelp">
                                                        </div>
                                                    </div>
                                                    <div class="col-md-12">
                                                        <div class="form-group">
                                                            <label for="miscDescription_${project_id}">Description de l'élément</label>
                                                            <textarea class="form-control" id="miscDescription_${project_id}" rows="5"></textarea>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-12">
                                                        <div class="form-group">
                                                            <label for="miscFile_${project_id}">Charger un document </label>
                                                            <input type="file" class="form-control-file" id="miscFile_${project_id}">
                                                        </div>
                                                    </div>
                                                    <div style="margin-top: 10px; padding: 10px;"></div>
                                                    <div class="col-md-12">
                                                        <button type="submit" class="btn btn-primary" id="buttonAddMisc_${project_id}">Ajouter l'élément</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                            </div>
                        </div>
                    `;
                    // Ajouter l'élément de liste dans la liste des projets
                    document.getElementById('projectsList').appendChild(li);

                    // Ajouter un gestionnaire d'événement pour chaque bouton "Compléter le projet ou Modifier le projet"
                    document.getElementById(`buttonModifier_${project_id}`).addEventListener('click', () => {

                        if (document.getElementById(`modifyProject_${project_id}`).style.display === 'none') {
                            document.getElementById(`modifyProject_${project_id}`).style.display = 'block';
                            document.getElementById(`modifyProject_${project_id}`).style.backgroundColor = 'lightred';

                            buttonText = 'Annuler les modifications';
                            // Supprimer toutes les informations des formulaires
                            document.getElementById(`newMemberEmail_${project_id}`).value = '';
                            document.getElementById(`newMemberRole_${project_id}`).value = '';
                            document.getElementById(`last_name_${project_id}`).value = '';
                            document.getElementById(`first_name_${project_id}`).value = '';
                            document.getElementById(`existingMemberEmail_${project_id}`).value = '';
                            document.getElementById(`existingMemberRole_${project_id}`).value = '';
                            document.getElementById(`reportTitle_${project_id}`).value = '';
                            document.getElementById(`reportDescription_${project_id}`).value = '';
                            document.getElementById(`documentTitle_${project_id}`).value = '';
                            document.getElementById(`documentDescription_${project_id}`).value = '';
                            document.getElementById(`documentFile_${project_id}`).value = '';
                            document.getElementById(`linkTitle_${project_id}`).value = '';
                            document.getElementById(`linkDescription_${project_id}`).value = '';
                            document.getElementById(`linkUrl_${project_id}`).value = '';
                            document.getElementById(`miscTitle_${project_id}`).value = '';
                            document.getElementById(`miscDescription_${project_id}`).value = '';
                            document.getElementById(`miscFile_${project_id}`).value = '';
                        } else {
                            document.getElementById(`modifyProject_${project_id}`).style.display = 'none';
                            document.getElementById(`modifyProject_${project_id}`).style.backgroundColor = '#29A6A7';
                            if (numberOfMembers === 0) {
                                buttonText = 'Compléter le projet';
                                projectStatus = 'Non commencé';
                            } else {
                                buttonText = 'Modifier le projet';
                                projectStatus = 'En cours';
                            }
                        }

                        // Réinitialiser les couleurs des boutons
                        document.getElementById(`buttonExistingMember_${project_id}`).style.backgroundColor = 'white';
                        document.getElementById(`buttonExistingMember_${project_id}`).style.color = '#29A6A7';
                        document.getElementById(`buttonNewMember_${project_id}`).style.backgroundColor = 'white';
                        document.getElementById(`buttonNewMember_${project_id}`).style.color = '#29A6A7';
                        document.getElementById(`buttonReportRequest_${project_id}`).style.backgroundColor = 'white';
                        document.getElementById(`buttonReportRequest_${project_id}`).style.color = '#29A6A7';
                        document.getElementById(`buttonDocumentModel_${project_id}`).style.backgroundColor = 'white';
                        document.getElementById(`buttonDocumentModel_${project_id}`).style.color = '#29A6A7';
                        document.getElementById(`buttonAddLink_${project_id}`).style.backgroundColor = 'white';
                        document.getElementById(`buttonAddLink_${project_id}`).style.color = '#29A6A7';
                        document.getElementById(`buttonAddDivers_${project_id}`).style.backgroundColor = 'white';
                        document.getElementById(`buttonAddDivers_${project_id}`).style.color = '#29A6A7';
                    });

                    // Ajouter un gestionnaire d'événement pour chaque bouton "Nouveau membre", "Membre existant", "Demande de rapport", "Document model", "Ajouter un lien", "Ajouter divers"
                    document.getElementById(`buttonExistingMember_${project_id}`).addEventListener('click', () => {
                        // Afficher le formulaire pour ajouter un membre existant
                        document.getElementById(`existingMember_${project_id}`).style.display = 'block';
                        document.getElementById('newMember_' + project_id).style.display = 'none';
                        document.getElementById('newReport_' + project_id).style.display = 'none';
                        document.getElementById('newDocument_' + project_id).style.display = 'none';
                        document.getElementById('newLink_' + project_id).style.display = 'none';
                        document.getElementById('newMisc_' + project_id).style.display = 'none';

                        // Changer le background du bouton cliqué
                        document.getElementById(`buttonExistingMember_${project_id}`).style.backgroundColor = '#29A6A7';
                        document.getElementById(`buttonExistingMember_${project_id}`).style.color = 'white';
                        document.getElementById(`buttonNewMember_${project_id}`).style.backgroundColor = 'white';
                        document.getElementById(`buttonNewMember_${project_id}`).style.color = '#29A6A7';
                        document.getElementById(`buttonReportRequest_${project_id}`).style.backgroundColor = 'white';
                        document.getElementById(`buttonReportRequest_${project_id}`).style.color = '#29A6A7';
                        document.getElementById(`buttonDocumentModel_${project_id}`).style.backgroundColor = 'white';
                        document.getElementById(`buttonDocumentModel_${project_id}`).style.color = '#29A6A7';
                        document.getElementById(`buttonAddLink_${project_id}`).style.backgroundColor = 'white';
                        document.getElementById(`buttonAddLink_${project_id}`).style.color = '#29A6A7';
                        document.getElementById(`buttonAddDivers_${project_id}`).style.backgroundColor = 'white';
                        document.getElementById(`buttonAddDivers_${project_id}`).style.color = '#29A6A7';
                    });

                    document.getElementById('buttonReportRequest_' + project_id).addEventListener('click', () => {
                        document.getElementById('newReport_' + project_id).style.display = 'block';
                        document.getElementById('newMember_' + project_id).style.display = 'none';
                        document.getElementById('existingMember_' + project_id).style.display = 'none';
                        document.getElementById('newDocument_' + project_id).style.display = 'none';
                        document.getElementById('newLink_' + project_id).style.display = 'none';
                        document.getElementById('newMisc_' + project_id).style.display = 'none';

                        // Changer le background du bouton cliqué
                        document.getElementById(`buttonExistingMember_${project_id}`).style.backgroundColor = 'white';
                        document.getElementById(`buttonExistingMember_${project_id}`).style.color = '#29A6A7';
                        document.getElementById(`buttonNewMember_${project_id}`).style.backgroundColor = 'white';
                        document.getElementById(`buttonNewMember_${project_id}`).style.color = '#29A6A7';
                        document.getElementById(`buttonReportRequest_${project_id}`).style.backgroundColor = '#29A6A7';
                        document.getElementById(`buttonReportRequest_${project_id}`).style.color = 'white';
                        document.getElementById(`buttonDocumentModel_${project_id}`).style.backgroundColor = 'white';
                        document.getElementById(`buttonDocumentModel_${project_id}`).style.color = '#29A6A7';
                        document.getElementById(`buttonAddLink_${project_id}`).style.backgroundColor = 'white';
                        document.getElementById(`buttonAddLink_${project_id}`).style.color = '#29A6A7';
                        document.getElementById(`buttonAddDivers_${project_id}`).style.backgroundColor = 'white';
                        document.getElementById(`buttonAddDivers_${project_id}`).style.color = '#29A6A7';
                    });

                    document.getElementById('buttonDocumentModel_' + project_id).addEventListener('click', () => {
                        document.getElementById('newDocument_' + project_id).style.display = 'block';
                        document.getElementById('newMember_' + project_id).style.display = 'none';
                        document.getElementById('existingMember_' + project_id).style.display = 'none';
                        document.getElementById('newReport_' + project_id).style.display = 'none';
                        document.getElementById('newLink_' + project_id).style.display = 'none';
                        document.getElementById('newMisc_' + project_id).style.display = 'none';

                        // Changer le background du bouton cliqué
                        document.getElementById(`buttonExistingMember_${project_id}`).style.backgroundColor = 'white';
                        document.getElementById(`buttonExistingMember_${project_id}`).style.color = '#29A6A7';
                        document.getElementById(`buttonNewMember_${project_id}`).style.backgroundColor = 'white';
                        document.getElementById(`buttonNewMember_${project_id}`).style.color = '#29A6A7';
                        document.getElementById(`buttonReportRequest_${project_id}`).style.backgroundColor = 'white';
                        document.getElementById(`buttonReportRequest_${project_id}`).style.color = '#29A6A7';
                        document.getElementById(`buttonDocumentModel_${project_id}`).style.backgroundColor = '#29A6A7';
                        document.getElementById(`buttonDocumentModel_${project_id}`).style.color = 'white';
                        document.getElementById(`buttonAddLink_${project_id}`).style.backgroundColor = 'white';
                        document.getElementById(`buttonAddLink_${project_id}`).style.color = '#29A6A7';
                        document.getElementById(`buttonAddDivers_${project_id}`).style.backgroundColor = 'white';
                        document.getElementById(`buttonAddDivers_${project_id}`).style.color = '#29A6A7';
                    });

                    document.getElementById('buttonNewMember_' + project_id).addEventListener('click', () => {
                        document.getElementById('newMember_' + project_id).style.display = 'block';
                        document.getElementById('existingMember_' + project_id).style.display = 'none';
                        document.getElementById('newReport_' + project_id).style.display = 'none';
                        document.getElementById('newDocument_' + project_id).style.display = 'none';
                        document.getElementById('newLink_' + project_id).style.display = 'none';
                        document.getElementById('newMisc_' + project_id).style.display = 'none';

                        // Changer le background du bouton cliqué
                        document.getElementById(`buttonExistingMember_${project_id}`).style.backgroundColor = 'white';
                        document.getElementById(`buttonExistingMember_${project_id}`).style.color = '#29A6A7';
                        document.getElementById(`buttonNewMember_${project_id}`).style.backgroundColor = '#29A6A7';
                        document.getElementById(`buttonNewMember_${project_id}`).style.color = 'white';
                        document.getElementById(`buttonReportRequest_${project_id}`).style.backgroundColor = 'white';
                        document.getElementById(`buttonReportRequest_${project_id}`).style.color = '#29A6A7';
                        document.getElementById(`buttonDocumentModel_${project_id}`).style.backgroundColor = 'white';
                        document.getElementById(`buttonDocumentModel_${project_id}`).style.color = '#29A6A7';
                        document.getElementById(`buttonAddLink_${project_id}`).style.backgroundColor = 'white';
                        document.getElementById(`buttonAddLink_${project_id}`).style.color = '#29A6A7';
                        document.getElementById(`buttonAddDivers_${project_id}`).style.backgroundColor = 'white';
                        document.getElementById(`buttonAddDivers_${project_id}`).style.color = '#29A6A7';
                    });

                    document.getElementById('buttonAddLink_' + project_id).addEventListener('click', () => {
                        document.getElementById('newLink_' + project_id).style.display = 'block';
                        document.getElementById('newMember_' + project_id).style.display = 'none';
                        document.getElementById('existingMember_' + project_id).style.display = 'none';
                        document.getElementById('newReport_' + project_id).style.display = 'none';
                        document.getElementById('newDocument_' + project_id).style.display = 'none';
                        document.getElementById('newMisc_' + project_id).style.display = 'none';

                        // Changer le background du bouton cliqué
                        document.getElementById(`buttonExistingMember_${project_id}`).style.backgroundColor = '#29A6A7';
                        document.getElementById(`buttonExistingMember_${project_id}`).style.color = 'white';
                        document.getElementById(`buttonNewMember_${project_id}`).style.backgroundColor = 'white';
                        document.getElementById(`buttonNewMember_${project_id}`).style.color = '#29A6A7';
                        document.getElementById(`buttonReportRequest_${project_id}`).style.backgroundColor = 'white';
                        document.getElementById(`buttonReportRequest_${project_id}`).style.color = '#29A6A7';
                        document.getElementById(`buttonDocumentModel_${project_id}`).style.backgroundColor = 'white';
                        document.getElementById(`buttonDocumentModel_${project_id}`).style.color = '#29A6A7';
                        document.getElementById(`buttonAddLink_${project_id}`).style.backgroundColor = 'white';
                        document.getElementById(`buttonAddLink_${project_id}`).style.color = '#29A6A7';
                        document.getElementById(`buttonAddDivers_${project_id}`).style.backgroundColor = 'white';
                        document.getElementById(`buttonAddDivers_${project_id}`).style.color = '#29A6A7';
                    });

                    document.getElementById('buttonAddDivers_' + project_id).addEventListener('click', () => {
                        document.getElementById('newMisc_' + project_id).style.display = 'block';
                        document.getElementById('newLink_' + project_id).style.display = 'none';
                        document.getElementById('newMember_' + project_id).style.display = 'none';
                        document.getElementById('existingMember_' + project_id).style.display = 'none';
                        document.getElementById('newReport_' + project_id).style.display = 'none';
                        document.getElementById('newDocument_' + project_id).style.display = 'none';

                        // Changer le background du bouton cliqué
                        document.getElementById(`buttonExistingMember_${project_id}`).style.backgroundColor = 'white';
                        document.getElementById(`buttonExistingMember_${project_id}`).style.color = '#29A6A7';
                        document.getElementById(`buttonNewMember_${project_id}`).style.backgroundColor = 'white';
                        document.getElementById(`buttonNewMember_${project_id}`).style.color = '#29A6A7';
                        document.getElementById(`buttonReportRequest_${project_id}`).style.backgroundColor = 'white';
                        document.getElementById(`buttonReportRequest_${project_id}`).style.color = '#29A6A7';
                        document.getElementById(`buttonDocumentModel_${project_id}`).style.backgroundColor = 'white';
                        document.getElementById(`buttonDocumentModel_${project_id}`).style.color = '#29A6A7';
                        document.getElementById(`buttonAddLink_${project_id}`).style.backgroundColor = 'white';
                        document.getElementById(`buttonAddLink_${project_id}`).style.color = '#29A6A7';
                        document.getElementById(`buttonAddDivers_${project_id}`).style.backgroundColor = '#29A6A7';
                        document.getElementById(`buttonAddDivers_${project_id}`).style.color = 'white';
                    });

                    // Ajouter un gestionnaire d'événement pour chaque bouton "Ajouter le nouveau membre", "Ajouter le nouveau rapport", "Ajouter le nouveau document", "Ajouter le nouveau lien", "Ajouter divers"
                    document.getElementById('buttonAddMember_' + project_id).addEventListener('click', () => {

                        var newMemberEmail = document.getElementById('newMemberEmail_' + project_id).value;
                        var newMemberRole = document.getElementById('newMemberRole_' + project_id).value;
                        var lastName = document.getElementById('last_name_' + project_id).value;
                        var firstName = document.getElementById('first_name_' + project_id).value;

                        if (newMemberEmail === '' || newMemberRole === '' || lastName === '' || firstName === '') {
                            alert('Veuillez remplir tous les champs.');
                            return;
                        }

                        var urls_and_data = {
                            'Coordinateur': {
                                'url': 'https://lab.padem.org/wp-json/mo/v1/createCoordinator',
                                'data': {
                                    'project_id': project_id,
                                    'coordinator_email': newMemberEmail,
                                    'coordinator_first_name': firstName,
                                    'coordinator_last_name': lastName,
                                    'coordinator_activity_history': JSON.stringify([
                                        {
                                            'hour': new Date().getHours(),
                                            'minute': new Date().getMinutes(),
                                            'day': new Date().getDate(),
                                            'month': new Date().getMonth() + 1,
                                            'year': new Date().getFullYear(),
                                        },
                                        {
                                            'Activité': `Création du projet ${project.project_title} et ajout des membres`,
                                        },
                                        {
                                            'Commentaire': 'Le projet est en cours de création',
                                        },
                                        {
                                            'Divers': '',
                                        }
                                    ]),
                                }
                            },
                            'chef-de-projet': {
                                'url': 'https://lab.padem.org/wp-json/mo/v1/createProjectChief',
                                'data': {
                                    'project_id': project_id,
                                    'chief_email': newMemberEmail,
                                    'chief_first_name': firstName,
                                    'chief_last_name': lastName,
                                    'chief_activity_history': JSON.stringify([
                                        {
                                            'hour': new Date().getHours(),
                                            'minute': new Date().getMinutes(),
                                            'day': new Date().getDate(),
                                            'month': new Date().getMonth() + 1,
                                            'year': new Date().getFullYear(),
                                        },
                                        {
                                            'Activité': `Création du projet ${project.project_title} et ajout des membres`,
                                        },
                                        {
                                            'Commentaire': 'Le projet est en cours de création',
                                        },
                                        {
                                            'Divers': '',
                                        }
                                    ]),
                                }
                            },
                            'comptable': {
                                'url': 'https://lab.padem.org/wp-json/mo/v1/createAccountant',
                                'data': {
                                    'project_id': project_id,
                                    'accountant_email': newMemberEmail,
                                    'accountant_first_name': firstName,
                                    'accountant_last_name': lastName,
                                    'accountant_activity_history': JSON.stringify([
                                        {
                                            'hour': new Date().getHours(),
                                            'minute': new Date().getMinutes(),
                                            'day': new Date().getDate(),
                                            'month': new Date().getMonth() + 1,
                                            'year': new Date().getFullYear(),
                                        },
                                        {
                                            'Activité': `Création du projet ${project.project_title} et ajout des membres`,
                                        },
                                        {
                                            'Commentaire': 'Le projet est en cours de création',
                                        },
                                        {
                                            'Divers': '',
                                        }
                                    ]),
                                }
                            },
                            'consultant': {
                                'url': 'https://lab.padem.org/wp-json/mo/v1/createConsultant',
                                'data': {
                                    'project_id': project_id,
                                    'consultant_email': newMemberEmail,
                                    'consultant_first_name': firstName,
                                    'consultant_last_name': lastName,
                                    'consultant_activity_history': JSON.stringify([
                                        {
                                            'hour': new Date().getHours(),
                                            'minute': new Date().getMinutes(),
                                            'day': new Date().getDate(),
                                            'month': new Date().getMonth() + 1,
                                            'year': new Date().getFullYear(),
                                        },
                                        {
                                            'Activité': `Création du projet ${project.project_title} et ajout des membres`,
                                        },
                                        {
                                            'Commentaire': 'Le projet est en cours de création',
                                        },
                                        {
                                            'Divers': '',
                                        }
                                    ]),
                                },
                            },
                            'partenaire': {
                                'url': 'https://lab.padem.org/wp-json/mo/v1/createPartner',
                                'data': {
                                    'project_id': project_id,
                                    'partner_email': newMemberEmail,
                                    'partner_first_name': firstName,
                                    'partner_last_name': lastName,
                                    'partner_activity_history': JSON.stringify([
                                        {
                                            'hour': new Date().getHours(),
                                            'minute': new Date().getMinutes(),
                                            'day': new Date().getDate(),
                                            'month': new Date().getMonth() + 1,
                                            'year': new Date().getFullYear(),
                                        },
                                        {
                                            'Activité': `Création du projet ${project.project_title} et ajout des membres`,
                                        },
                                        {
                                            'Commentaire': 'Le projet est en cours de création',
                                        },
                                        {
                                            'Divers': '',
                                        }
                                    ]),
                                },
                            },
                            'bailleur': {
                                'url': 'https://lab.padem.org/wp-json/mo/v1/createBailleur',
                                'data': {
                                    'project_id': project_id,
                                    'bailleur_email': newMemberEmail,
                                    'bailleur_first_name': firstName,
                                    'bailleur_last_name': lastName,
                                    'bailleur_activity_history': JSON.stringify([
                                        {
                                            'hour': new Date().getHours(),
                                            'minute': new Date().getMinutes(),
                                            'day': new Date().getDate(),
                                            'month': new Date().getMonth() + 1,
                                            'year': new Date().getFullYear(),
                                        },
                                        {
                                            'Activité': `Création du projet ${project.project_title} et ajout des membres`,
                                        },
                                        {
                                            'Commentaire': 'Le projet est en cours de création',
                                        },
                                        {
                                            'Divers': '',
                                        }
                                    ]),
                                },
                            }
                        };

                        fetch(urls_and_data[newMemberRole].url, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify(urls_and_data[newMemberRole].data),
                        })
                            .then(response => response.json())
                            .then(data => {
                                // Récupérer l'ID du nouveau membre
                                var newMemberId;
                                if (data.accountant_id !== undefined) {
                                    newMemberId = data.accountant_id;
                                }
                                else if (data.funder_id !== undefined) {
                                    newMemberId = data.funder_id;
                                }
                                else if (data.partner_id !== undefined) {
                                    newMemberId = data.partner_id;
                                }
                                else if (data.coordinator_id !== undefined) {
                                    newMemberId = data.coordinator_id;
                                }
                                else if (data.chief_id !== undefined) {
                                    newMemberId = data.chief_id;
                                }
                                else if (data.consultant_id !== undefined) {
                                    newMemberId = data.consultant_id;
                                }
                                else if (data.referent_id !== undefined) {
                                    newMemberId = data.referent_id;
                                }
                                else {
                                    console.log('Erreur lors de la création du nouveau membre');
                                    return;
                                }

                                // Ajouter l'ID du nouveau membre à la liste des membres du projet sur la base de données
                                fetch('https://lab.padem.org/wp-json/mo/v1/updateOneProject',
                                    {
                                        method: 'PUT',
                                        headers: {
                                            'Content-Type': 'application/json',
                                        },
                                        body: JSON.stringify({
                                            'project_id': project_id,
                                            'user_list': JSON.stringify({
                                                'id': project_id + '-' + newMemberId + '-' + new Date().getTime(),
                                                'user_id': newMemberId,
                                            }),
                                        }),
                                    })
                                    .then(response => response.json())
                                    .then(data => {
                                        console.log(data);
                                        // Recharger la page
                                        window.location.href = 'https://lab.padem.org/project/';
                                    })
                                    .catch(error => {
                                        console.error(error);
                                    });
                            })
                            .catch(error => {
                                console.error(error);
                            });
                    });

                    // Ajouter un membre existant au projet sur la base de données
                    document.getElementById('addExistingMember_' + project_id).addEventListener('click', () => {
                        var existingMemberEmail = document.getElementById('existingMemberEmail_' + project_id).value;
                        var existingMemberRole = document.getElementById('existingMemberRole_' + project_id).value;
                        var existingMember_first_name = document.getElementById('existingMember_first_name_' + project_id).value; 
                        var existingMember_last_name = document.getElementById('existingMember_last_name_' + project_id).value;

                        if (!existingMemberEmail || !existingMemberRole || !existingMember_first_name || !existingMember_last_name) {
                            alert('Veuillez remplir tous les champs.');
                            return;
                        }

                        var urls_and_data = {
                            'Coordinateur': {
                                'url': 'https://lab.padem.org/wp-json/mo/v1/createCoordinator',
                                'data': {
                                    'project_id': project_id,
                                    'coordinator_email': existingMemberEmail,
                                    'coordinator_first_name': existingMember_first_name,
                                    'coordinator_last_name': existingMember_last_name,
                                    'coordinator_activity_history': JSON.stringify([
                                        {
                                            'Date': {
                                                'hour': new Date().getHours(),
                                                'minute': new Date().getMinutes(),
                                                'day': new Date().getDate(),
                                                'month': new Date().getMonth() + 1,
                                                'year': new Date().getFullYear(),
                                            }
                                        },
                                        {
                                            'Activité': `Création du projet ${project.project_title} et ajout des membres`,
                                        },
                                        {
                                            'Commentaire': 'Le projet est en cours de création',
                                        },
                                        {
                                            'Divers': '',
                                        }
                                    ]),
                                }
                            },
                            'chef-de-projet': {
                                'url': 'https://lab.padem.org/wp-json/mo/v1/createProjectChief',
                                'data': {
                                    'project_id': project_id,
                                    'chief_email': existingMemberEmail,
                                    'chief_first_name': existingMember_first_name,
                                    'chief_last_name': existingMember_last_name,
                                    'chief_activity_history': JSON.stringify([
                                        {
                                            'Date': {
                                                'hour': new Date().getHours(),
                                                'minute': new Date().getMinutes(),
                                                'day': new Date().getDate(),
                                                'month': new Date().getMonth() + 1,
                                                'year': new Date().getFullYear(),
                                            }
                                        },
                                        {
                                            'Activité': `Création du projet ${project.project_title} et ajout des membres`,
                                        },
                                        {
                                            'Commentaire': 'Le projet est en cours de création',
                                        },
                                        {
                                            'Divers': '',
                                        }
                                    ]),
                                }
                            },
                            'comptable': {
                                'url': 'https://lab.padem.org/wp-json/mo/v1/createAccountant',
                                'data': {
                                    'project_id': project_id,
                                    'accountant_email': existingMemberEmail,
                                    'accountant_first_name': existingMember_first_name,
                                    'accountant_last_name': existingMember_last_name,
                                    'accountant_activity_history': JSON.stringify([
                                        {
                                            'Date': {
                                                'hour': new Date().getHours(),
                                                'minute': new Date().getMinutes(),
                                                'day': new Date().getDate(),
                                                'month': new Date().getMonth() + 1,
                                                'year': new Date().getFullYear(),
                                            }
                                        },
                                        {
                                            'Activité': `Création du projet ${project.project_title} et ajout des membres`,
                                        },
                                        {
                                            'Commentaire': 'Le projet est en cours de création',
                                        },
                                        {
                                            'Divers': '',
                                        },
                                        {
                                            'Activité': `Création du projet ${project.project_title} et ajout des membres`,
                                        },
                                        {
                                            'Commentaire': 'Le projet est en cours de création',
                                        },
                                        {
                                            'Divers': '',
                                        }
                                    ]),
                                },
                            },
                            'consultant': {
                                'url': 'https://lab.padem.org/wp-json/mo/v1/createConsultant',
                                'data': {
                                    'project_id': project_id,
                                    'consultant_email': existingMemberEmail,
                                    'consultant_first_name': existingMember_first_name,
                                    'consultant_last_name': existingMember_last_name,
                                    'consultant_activity_history': JSON.stringify([
                                        {
                                            'Date': {
                                                'hour': new Date().getHours(),
                                                'minute': new Date().getMinutes(),
                                                'day': new Date().getDate(),
                                                'month': new Date().getMonth() + 1,
                                                'year': new Date().getFullYear(),
                                            },
                                        },
                                        {
                                            'activite': `Création du projet ${project.project_title} et ajout des membres`,
                                        },
                                        {
                                            'commentaire': 'Le projet est en cours de création',
                                        },
                                        {
                                            'Divers': '',
                                        }
                                    ]),
                                },
                            },
                            'partenaire': {
                                'url': 'https://lab.padem.org/wp-json/mo/v1/createPartner',
                                'data': {
                                    'project_id': project_id,
                                    'partner_email': existingMemberEmail,
                                    'partner_first_name': existingMember_first_name,
                                    'partner_last_name': existingMember_last_name,
                                    'partner_activity_history': JSON.stringify([
                                        {
                                            'Date': {
                                                'hour': new Date().getHours(),
                                                'minute': new Date().getMinutes(),
                                                'day': new Date().getDate(),
                                                'month': new Date().getMonth() + 1,
                                                'year': new Date().getFullYear(),
                                            },
                                        },
                                        {
                                            'activite': `Création du projet ${project.project_title} et ajout des membres`,
                                        },
                                        {
                                            'commentaire': 'Le projet est en cours de création',
                                        },
                                        {
                                            'Divers': '',
                                        }
                                    ]),
                                },
                            },
                            'bailleur': {
                                'url': 'https://lab.padem.org/wp-json/mo/v1/createFunder',
                                'data': {
                                    'project_id': project_id,
                                    'bailleur_email': existingMemberEmail,
                                    'bailleur_first_name': existingMember_first_name,
                                    'bailleur_last_name': existingMember_last_name,
                                    'bailleur_activity_history': JSON.stringify([
                                        {
                                            'Date': {
                                                'hour': new Date().getHours(),
                                                'minute': new Date().getMinutes(),
                                                'day': new Date().getDate(),
                                                'month': new Date().getMonth() + 1,
                                                'year': new Date().getFullYear(),
                                            },
                                        },
                                        {
                                            'activite': `Création du projet ${project.project_title} et ajout des membres`,
                                        },
                                        {
                                            'commentaire': 'Le projet est en cours de création',
                                        },
                                        {
                                            'Divers': '',
                                        }
                                    ]),
                                },
                            },
                        };

                        fetch(urls_and_data[existingMemberRole].url, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify(urls_and_data[existingMemberRole].data),
                        })
                            .then(response => response.json())
                            .then(data => {
                                // Récupérer l'ID du nouveau membre
                                var existingMemberId;
                                if (data.accountant_id !== undefined) {
                                    existingMemberId = data.accountant_id;
                                }
                                else if (data.funder_id !== undefined) {
                                    existingMemberId = data.funder_id;
                                }
                                else if (data.partner_id !== undefined) {
                                    existingMemberId = data.partner_id;
                                }
                                else if (data.coordinator_id !== undefined) {
                                    existingMemberId = data.coordinator_id;
                                }
                                else if (data.chief_id !== undefined) {
                                    existingMemberId = data.chief_id;
                                }
                                else if (data.consultant_id !== undefined) {
                                    existingMemberId = data.consultant_id;
                                }
                                else if (data.referent_id !== undefined) {
                                    existingMemberId = data.referent_id;
                                }
                                else {
                                    console.log('Erreur lors de la création du nouveau membre');
                                    return;
                                }

                                // Ajouter l'ID du nouveau membre à la liste des membres du projet sur la base de données
                                fetch('https://lab.padem.org/wp-json/mo/v1/updateOneProject',
                                    {
                                        method: 'PUT',
                                        headers: {
                                            'Content-Type': 'application/json',
                                        },
                                        body: JSON.stringify({
                                            'project_id': project_id,
                                            'user_list': JSON.stringify({
                                                'id': project_id + '-' + existingMemberId + '-' + new Date().getTime(),
                                                'user_id': existingMemberId,
                                            }),
                                        }),
                                    })
                                    .then(response => response.json())
                                    .then(data => {
                                        console.log(data);
                                        // Recharger la page
                                        window.location.href = 'https://lab.padem.org/project/';
                                    })
                                    .catch(error => {
                                        console.error(error);
                                    });
                            })
                            .catch(error => {
                                console.error(error);
                            });
                    });

                    // Ajouter un rapport au projet sur la base de données
                    document.getElementById('reportSubmit_' + project_id).addEventListener('click', () => {
                        var reportTitle = document.getElementById('reportTitle_' + project_id).value;
                        var reportDescription = document.getElementById('reportDescription_' + project_id).value;

                        if (!reportTitle || !reportDescription) {
                            alert('Veuillez remplir tous les champs.');
                            return;
                        }

                        fetch('https://lab.padem.org/wp-json/mo/v1/createReport',
                            {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json',
                                },
                                body: JSON.stringify({
                                    'project_id': project_id,
                                    'report_title': reportTitle,
                                    'report_description': reportDescription,
                                }),
                            })
                            .then(response => response.json())
                            .then(data => {
                                // Récupérer l'ID du nouveau rapport
                                var reportId = data.report_id;

                                // Ajouter l'ID du nouveau rapport à la liste des rapports du projet sur la base de données
                                fetch('https://lab.padem.org/wp-json/mo/v1/updateOneProject',
                                    {
                                        method: 'PUT',
                                        headers: {
                                            'Content-Type': 'application/json',
                                        },
                                        body: JSON.stringify({
                                            'project_id': project_id,
                                            'report_list': JSON.stringify({
                                                'id': project_id + '-' + reportId + '-' + new Date().getTime(),
                                                'report_id': reportId,
                                            }),
                                        }),
                                    })
                                    .then(response => response.json())
                                    .then(data => {
                                        console.log(data);
                                        // Recharger la page
                                        window.location.href = 'https://lab.padem.org/project/';
                                    })
                                    .catch(error => {
                                        console.error(error);
                                    });
                            })
                            .catch(error => {
                                console.error(error);
                            });
                    });


                    stepper++;
                    if (stepper === 2) {
                        li.style.borderColor = '#29A6A7';
                        stepper = 0;
                    }
                });
            })
            .catch(error => {
                console.error(error);
            });


    });
</script>
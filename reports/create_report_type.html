<!-- Afficher la liste des types de rapport existants -->
<div class="container" style="color: gray;">
    <div class="row">
        <div class="col-md-12">
            <ul class="list-group" id="reportTypesList_" style="list-style: none;">
                <!-- Les types de rapport seront affichés ici -->
            </ul>
        </div>
    </div>
</div>



<body>
    <!-- Bouton pour afficher/masquer le formulaire -->
    <div class="form-group">
        <button type="button" class="btn btn-secondary" id="cancelButton" style="display: block;"
            onclick="showAndHideProjectForm(); cancelForm();" style="width: min-content;">Nouveau filtre</button>
    </div>

    <!-- Formulaire de création de type de rapport -->
    <div id="report_type" style="display: none;">
        <form class="container" style=" border-radius: 15px; margin-top: 15px; background-color: white;">
            <div class="form-group">
                <label for="projectName">Nom du type de rapport: <span style="color: red;">*</span></label>
                <input type="text" class="form-control" id="projectName" placeholder="Nom du type de rapport">
            </div>
            <div class="form-group">
                <label for="projectDescription">Description du type de rapport: <span
                        style="color: red;">*</span></label>
                <textarea class="form-control" id="projectDescription" rows="4"
                    placeholder="Description du type de rapport"></textarea>
            </div>
            <div style="margin: 15px;"></div>
            <div class="form-group">
                <button type="button" class="btn btn-primary" onclick="createReportType();"
                    style="width: fit-content;">Enregistrer</button>
            </div>
        </form>
    </div>


    <!-- Fonction pour afficher/masquer le formulaire de création de type de rapport -->
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            displayAvailableReportTypes();
        });

        function createReportType() {
            var projectName = document.getElementById('projectName').value;
            var projectDescription = document.getElementById('projectDescription').value;

            if(projectName === '' && projectDescription === '')

            fetch('https://lab.padem.org/wp-json/mo/v1/createReportType', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    'report_type_name': projectName,
                    'report_type_description': projectDescription
                })
            })
                .then(response => response.json())
                .then(data => {
                    console.log('Success:', data);
                    location.reload();
                })
                .catch((error) => {
                    console.error('Error:', error);
                });
        }

        function displayAvailableReportTypes() {
            fetch('https://lab.padem.org/wp-json/mo/v1/getReportTypes', {
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json'
                }
            })
                .then(response => response.json())
                .then(data => {
                    var reportTypesList = document.getElementById('reportTypesList_');
                    data.forEach(reportType => {
                        var li = document.createElement('li');
                        li.innerHTML = `
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="card" style="margin-top: 15px;">
                                        <div class="card-body">
                                            <h5 class="card-title">${reportType.report_type_name}</h5>
                                            <p class="card-text">${reportType.report_type_description}</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `;
                        reportTypesList.appendChild(li);
                    });
                    if (data.length === 0) {
                        reportTypesList.innerHTML = '<h5 style="color: gray;">Aucun type de rapport disponible pour le moment.</h5>';
                    }
                })
        }

        function cancelForm() {
            document.getElementById('projectName').value = '';
            document.getElementById('projectDescription').value = '';
        }

        function showAndHideProjectForm() {
            var projectForm = document.getElementById('report_type');
            if (projectForm.style.display === 'none') {
                projectForm.style.display = 'block';
                document.getElementById('cancelButton').innerText = 'Annuler';
            } else {
                projectForm.style.display = 'none';
                document.getElementById('cancelButton').innerText = 'Nouveau filtre';
            }
        }

        function showAndHideCancelButton() {
            var cancelButton = document.getElementById('cancelButton');
            if (cancelButton.style.display === 'none') {
                cancelButton.style.display = 'block';
            } else {
                cancelButton.style.display = 'none';
            }
        }

        function switchAddProjectButtonIcon(icon) {
            var addProjectButton = document.getElementById('addProjectButton');
            addProjectButton.innerHTML = `<img src="https://lab.padem.org/wp-content/uploads/${icon}.png" alt="${icon}" id="${icon}" title="Ajouter un projet" /> Ajouter un type de rapport`;
        }

    </script>
</body>